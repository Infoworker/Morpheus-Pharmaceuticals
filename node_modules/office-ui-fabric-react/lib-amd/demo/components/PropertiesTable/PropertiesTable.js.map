{"version":3,"sources":["demo/components/PropertiesTable/PropertiesTable.tsx"],"names":[],"mappings":"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","file":"demo/components/PropertiesTable/PropertiesTable.js","sourcesContent":["import * as React from 'react';\nimport './PropertiesTable.scss';\nimport { DetailsList, DetailsListLayoutMode, IColumn, IGroup } from '../../../DetailsList';\nimport { SelectionMode } from '../../../utilities/selection/interfaces';\nimport { assign } from '../../../utilities/object';\n\nexport interface IProperty {\n  name: string;\n  propertyName: string;\n  propertyType: PropertyType;\n  property: IInterfaceProperty[] | IEnumProperty[];\n}\n\nexport interface IInterfaceProperty {\n  name: string;\n  type: string;\n  defaultValue: string;\n  description: string;\n  interfacePropertyType: InterfacePropertyType;\n  deprecatedMessage: string;\n}\n\nexport enum InterfacePropertyType {\n  required = 0,\n  optional = 1,\n  deprecated = 2\n}\n\nexport interface IEnumProperty {\n  name: string;\n  description: string;\n}\n\nexport interface IPropertiesTableProps {\n  title?: string;\n  properties: IInterfaceProperty[] | IEnumProperty[];\n  renderAsEnum?: boolean;\n  key?: string;\n}\n\nexport enum PropertyType {\n  enum, interface\n}\n\nconst DEFAULT_COLUMNS: IColumn[] = [\n  {\n    key: 'name',\n    name: 'Name',\n    fieldName: 'name',\n    minWidth: 150,\n    maxWidth: 250,\n    isCollapsable: false,\n    isRowHeader: true,\n    isResizable: true\n  },\n  {\n    key: 'type',\n    name: 'Type',\n    fieldName: 'type',\n    minWidth: 130,\n    maxWidth: 150,\n    isCollapsable: false,\n    isResizable: true\n  },\n  {\n    key: 'defaultValue',\n    name: 'Default value',\n    fieldName: 'defaultValue',\n    minWidth: 130,\n    maxWidth: 150,\n    isCollapsable: false,\n    isResizable: true\n  }, {\n    key: 'description',\n    name: 'Description',\n    fieldName: 'description',\n    minWidth: 300,\n    maxWidth: 400,\n    isCollapsable: false,\n    isResizable: true,\n    isMultiline: true\n  }\n];\n\nconst ENUM_COLUMNS: IColumn[] = [\n  {\n    key: 'name',\n    name: 'Name',\n    fieldName: 'name',\n    minWidth: 150,\n    maxWidth: 250,\n    isCollapsable: false,\n    isRowHeader: true,\n    isResizable: true\n  },\n  {\n    key: 'description',\n    name: 'Description',\n    fieldName: 'description',\n    minWidth: 300,\n    maxWidth: 400,\n    isCollapsable: false,\n    isResizable: true\n  }\n];\n\nexport class PropertiesTable extends React.Component<IPropertiesTableProps, any> {\n  public static defaultProps = {\n    title: 'Properties'\n  };\n\n  constructor(props: IPropertiesTableProps) {\n    super(props);\n\n    let properties = (props.properties as any[])\n        .map((prop, index) => assign({ key: index }, prop))\n        .sort((a, b) => (a.name > b.name) ? -1 : 1)\n        .sort((a, b) => (a.interfacePropertyType < b.interfacePropertyType) ? -1 : 1);\n\n    let groups = null;\n\n    if (!props.renderAsEnum) {\n      groups = this._getGroups(properties);\n    }\n\n    this.state = {\n      properties,\n      groups,\n      isEnum: !!props.renderAsEnum\n    };\n  }\n\n  public render() {\n    let { title } = this.props;\n    let { properties, isEnum, groups } = this.state;\n\n    return (\n      <div className='PropertiesTable'>\n        <h2 className='ms-font-xl'>{ title }</h2>\n        { (properties && properties.length) ? (\n          <DetailsList\n            selectionMode={ SelectionMode.none }\n            layoutMode={ DetailsListLayoutMode.justified }\n            items={ properties }\n            groups={ groups }\n            columns={ isEnum ? ENUM_COLUMNS : DEFAULT_COLUMNS }\n            />\n        ) : (\n            <div className='PropertiesTable-noProperties'>This component is missing properties. Please provide properties or remove the table from the example.</div>\n          ) }\n        </div>\n    );\n  }\n\n  private _getGroups(props: IInterfaceProperty[]) {\n    let groups: IGroup[] = [];\n    let index = 0;\n\n    index = this._tryAddGroup(props, InterfacePropertyType.required, 'Required members', index, groups);\n    index = this._tryAddGroup(props, InterfacePropertyType.optional, 'Optional members', index, groups);\n    index = this._tryAddGroup(props, InterfacePropertyType.deprecated, 'Deprecated members', index, groups);\n\n    return groups;\n  }\n\n  private _tryAddGroup(props, typeToCompare: InterfacePropertyType, name: string, index: number, allGroups): number {\n    let group: IGroup;\n\n    while (index < props.length) {\n      let prop = props[index] ;\n\n      if (prop.interfacePropertyType !== typeToCompare) {\n        break;\n      }\n\n      if (!group) {\n        group = {\n          key: name,\n          name,\n          startIndex: index,\n          count: 0\n        };\n        allGroups.push(group);\n      }\n      group.count++;\n      index++;\n    }\n\n    return index;\n  }\n}\n"],"sourceRoot":"../../../../src"}