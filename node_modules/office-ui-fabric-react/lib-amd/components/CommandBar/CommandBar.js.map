{"version":3,"sources":["components/CommandBar/CommandBar.tsx"],"names":[],"mappings":"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","file":"components/CommandBar/CommandBar.js","sourcesContent":["import * as React from 'react';\nimport { ICommandBar, ICommandBarProps } from './CommandBar.Props';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport { ContextualMenu, IContextualMenuItem } from '../../ContextualMenu';\nimport { EventGroup } from '../../utilities/eventGroup/EventGroup';\nimport { DirectionalHint } from '../../common/DirectionalHint';\nimport { autobind } from '../../utilities/autobind';\nimport { css } from '../../utilities/css';\nimport { getId } from '../../utilities/object';\nimport { buttonProperties, divProperties, getNativeProps } from '../../utilities/properties';\nimport './CommandBar.scss';\n\nconst OVERFLOW_KEY = 'overflow';\nconst OVERFLOW_WIDTH = 41.5;\n\nexport interface ICommandBarState {\n  renderedItems?: IContextualMenuItem[];\n  renderedOverflowItems?: IContextualMenuItem[];\n  expandedMenuItemKey?: string;\n  expandedMenuId?: string;\n  contextualMenuItems?: IContextualMenuItem[];\n  contextualMenuTarget?: HTMLElement;\n  renderedFarItems?: IContextualMenuItem[];\n}\n\nexport class CommandBar extends React.Component<ICommandBarProps, ICommandBarState> implements ICommandBar {\n  public static defaultProps = {\n    items: [],\n    overflowItems: [],\n    farItems: []\n  };\n\n  public refs: {\n    [key: string]: React.ReactInstance;\n    commandSurface: HTMLElement;\n    farCommandSurface: HTMLElement;\n    commandBarRegion: HTMLElement;\n    searchSurface: HTMLElement;\n    focusZone: FocusZone;\n  };\n\n  private _id: string;\n  private _overflowWidth: number;\n  private _commandItemWidths: { [key: string]: number };\n  private _events: EventGroup;\n\n  constructor(props: ICommandBarProps) {\n    super(props);\n\n    this.state = this._getStateFromProps(props);\n\n    this._id = getId('CommandBar');\n    this._events = new EventGroup(this);\n  }\n\n  public componentDidMount() {\n    this._updateItemMeasurements();\n    this._updateRenderedItems();\n\n    this._events.on(window, 'resize', this._updateRenderedItems);\n  }\n\n  public componentWillUnmount() {\n    this._events.dispose();\n  }\n\n  public componentWillReceiveProps(nextProps: ICommandBarProps) {\n    this.setState(this._getStateFromProps(nextProps));\n    this._commandItemWidths = null;\n  }\n\n  public componentDidUpdate(prevProps: ICommandBarProps, prevStates: ICommandBarState) {\n    if (!this._commandItemWidths) {\n      this._updateItemMeasurements();\n      this._updateRenderedItems();\n    }\n  }\n\n  public render() {\n    const { isSearchBoxVisible, searchPlaceholderText, className } = this.props;\n    const { renderedItems, contextualMenuItems, expandedMenuItemKey, expandedMenuId, renderedOverflowItems, contextualMenuTarget, renderedFarItems } = this.state;\n    let searchBox;\n\n    if (isSearchBoxVisible) {\n      searchBox = (\n        <div className='ms-CommandBarSearch' ref='searchSurface'>\n          <input className='ms-CommandBarSearch-input' type='text' placeholder={ searchPlaceholderText } />\n          <div className='ms-CommandBarSearch-iconWrapper ms-CommandBarSearch-iconSearchWrapper'>\n            <i className='ms-Icon ms-Icon--Search'></i>\n          </div>\n          <div className='ms-CommandBarSearch-iconWrapper ms-CommandBarSearch-iconClearWrapper ms-font-s'>\n            <i className='ms-Icon ms-Icon--Cancel'></i>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className={ css('ms-CommandBar', className) } ref='commandBarRegion'>\n        { searchBox }\n        <FocusZone ref='focusZone' direction={ FocusZoneDirection.horizontal } rootProps={ { role: 'menubar' } }>\n          <div className='ms-CommandBar-primaryCommands' ref='commandSurface'>\n            { renderedItems.map((item, index) => (\n              this._renderItemInCommandBar(item, index, expandedMenuItemKey)\n            )).concat((renderedOverflowItems && renderedOverflowItems.length) ? [\n            <div className='ms-CommandBarItem' key={ OVERFLOW_KEY } ref={ OVERFLOW_KEY }>\n              <button\n                id={ this._id + OVERFLOW_KEY }\n                className={ css('ms-CommandBarItem-link', { 'is-expanded': (expandedMenuItemKey === OVERFLOW_KEY) }) }\n                onClick={ this._onOverflowClick }\n                role='menuitem'\n                aria-label={ this.props.elipisisAriaLabel || '' }\n                aria-haspopup={ true }\n                data-automation-id='commandBarOverflow'\n              >\n                <i className='ms-CommandBarItem-overflow ms-Icon ms-Icon--More' />\n              </button>\n            </div>\n            ] : []) }\n          </div>\n          <div className='ms-CommandBar-sideCommands' ref='farCommandSurface'>\n            { renderedFarItems.map((item, index) => (\n              this._renderItemInCommandBar(item, index, expandedMenuItemKey, true)\n            )) }\n          </div>\n        </FocusZone>\n        { (contextualMenuItems) ?\n        (<ContextualMenu\n          labelElementId={ expandedMenuId }\n          className='ms-CommandBar-menuHost'\n          items={ contextualMenuItems }\n          targetElement={ contextualMenuTarget }\n          onDismiss={ this._onContextMenuDismiss }\n          isBeakVisible={ true }\n          directionalHint={ DirectionalHint.bottomAutoEdge }\n        />\n        ) : (null)}\n      </div>\n    );\n  }\n\n  public focus() {\n    this.refs.focusZone.focus();\n  }\n\n  private _renderItemInCommandBar(item: IContextualMenuItem, index: number, expandedMenuItemKey: string, isFarItem?: boolean) {\n    const itemKey = item.key || String(index);\n    const className = css(item.onClick ? 'ms-CommandBarItem-link' : 'ms-CommandBarItem-text', !item.name && 'ms-CommandBarItem--noName');\n    const classNameValue = css(className, { 'is-expanded': (expandedMenuItemKey === item.key) });\n\n    return <div className={ css('ms-CommandBarItem', item.className) } key={ itemKey } ref={ itemKey }>\n             {(() => {\n               if (item.onClick || item.items) {\n                 return <button\n                         { ...getNativeProps(item, buttonProperties) }\n                         id={ this._id + item.key }\n                         className={ classNameValue }\n                         onClick={ this._onItemClick.bind(this, item) }\n                         data-command-key={ index }\n                         aria-haspopup={ !!(item.items && item.items.length) }\n                         role='menuitem'\n                         aria-label={ item.ariaLabel || item.name }\n                       >\n                         { (!!item.icon) && <span className={ `ms-CommandBarItem-icon ms-Icon ms-Icon--${ item.icon }` }></span> }\n                         { (!!item.name) && <span className='ms-CommandBarItem-commandText'>{ item.name }</span> }\n                         { (item.items && item.items.length) ? (\n                           <i className='ms-CommandBarItem-chevronDown ms-Icon ms-Icon--ChevronDown' />\n                         ) : ( null ) }\n                       </button>;\n               } else {\n                 return <div\n                         { ...getNativeProps(item, divProperties) }\n                         id={ this._id + item.key }\n                         className={ classNameValue }\n                         data-command-key={ index }\n                         aria-haspopup={ !!(item.items && item.items.length) }\n                       >\n                         <span className={ `ms-CommandBarItem-icon ms-Icon ms-Icon--${ item.icon }` }></span>\n                         <span className='ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular' aria-hidden='true' role='presentation'>{ item.name }</span>\n                       </div>;\n               }\n             })()}\n           </div>;\n  }\n\n  private _updateItemMeasurements() {\n    // the generated width for overflow is 35 in chrome, 38 in IE, but the actual value is 41.5\n    if (this.refs[OVERFLOW_KEY] || (this.props.overflowItems && this.props.overflowItems.length)) {\n      this._overflowWidth = OVERFLOW_WIDTH;\n    } else {\n      this._overflowWidth = 0;\n    }\n\n    if (!this._commandItemWidths) {\n      this._commandItemWidths = {};\n    }\n\n    for (let i = 0; i < this.props.items.length; i++) {\n      let item = this.props.items[i];\n\n      if (!this._commandItemWidths[item.key]) {\n        let el = this.refs[item.key] as HTMLElement;\n\n        if (el) {\n          this._commandItemWidths[item.key] = el.getBoundingClientRect().width;\n        }\n      }\n    }\n  }\n\n  private _updateRenderedItems() {\n    let { items, overflowItems } = this.props;\n    let commandSurface = this.refs.commandSurface;\n    let farCommandSurface = this.refs.farCommandSurface;\n    let commandBarRegion = this.refs.commandBarRegion;\n    let searchSurface = this.refs.searchSurface;\n    let renderedItems = [].concat(items);\n    let renderedOverflowItems = overflowItems;\n    let consumedWidth = 0;\n    let isOverflowVisible = overflowItems && overflowItems.length;\n\n    let style = window.getComputedStyle(commandSurface);\n    let availableWidth = commandBarRegion.clientWidth - parseInt(style.marginLeft, 10) - parseInt(style.marginRight, 10);\n    if (searchSurface) {\n      availableWidth -= searchSurface.getBoundingClientRect().width;\n    }\n    if (farCommandSurface) {\n      availableWidth -= farCommandSurface.getBoundingClientRect().width;\n    }\n\n    if (isOverflowVisible) {\n      availableWidth -= this._overflowWidth;\n    }\n\n    for (let i = 0; i < renderedItems.length; i++) {\n      let item = renderedItems[i];\n      let itemWidth = this._commandItemWidths[item.key];\n\n      if ((consumedWidth + itemWidth) >= availableWidth) {\n        if (i > 0 && !isOverflowVisible && (availableWidth - consumedWidth) < OVERFLOW_WIDTH) {\n          i--;\n        }\n\n        renderedOverflowItems = renderedItems.splice(i).concat(overflowItems);\n        break;\n      } else {\n        consumedWidth += itemWidth;\n      }\n\n    }\n\n    this.setState({\n      renderedItems: renderedItems,\n      renderedOverflowItems: renderedOverflowItems,\n      expandedMenuItemKey: null,\n      contextualMenuItems: null,\n      contextualMenuTarget: null\n    });\n  }\n\n  private _onItemClick(item, ev) {\n    if (item.key === this.state.expandedMenuItemKey || !item.items || !item.items.length) {\n      this._onContextMenuDismiss();\n    } else {\n      this.setState({\n        expandedMenuId: ev.currentTarget.id,\n        expandedMenuItemKey: item.key,\n        contextualMenuItems: item.items,\n        contextualMenuTarget: ev.currentTarget\n      });\n    }\n    if (item.onClick) {\n      item.onClick(item, ev);\n    }\n  }\n\n  @autobind\n  private _onOverflowClick(ev) {\n    if (this.state.expandedMenuItemKey === OVERFLOW_KEY) {\n      this._onContextMenuDismiss();\n    } else {\n      this.setState({\n        expandedMenuId: ev.currentTarget.id,\n        expandedMenuItemKey: OVERFLOW_KEY,\n        contextualMenuItems: this.state.renderedOverflowItems,\n        contextualMenuTarget: ev.currentTarget\n      });\n    }\n  }\n\n  @autobind\n  private _onContextMenuDismiss(ev?: any) {\n    if (!ev || !ev.relatedTarget || !this.refs.commandSurface.contains(ev.relatedTarget as HTMLElement)) {\n      this.setState({\n        expandedMenuItemKey: null,\n        contextualMenuItems: null,\n        contextualMenuTarget: null\n      });\n    } else {\n      ev.stopPropagation();\n      ev.preventDefault();\n    }\n  }\n\n  private _getStateFromProps(nextProps: ICommandBarProps) {\n    return {\n      renderedItems: nextProps.items || [],\n      renderedOverflowItems: null,\n      contextualMenuItems: null,\n      renderedFarItems: nextProps.farItems || null\n    };\n  }\n}\n"],"sourceRoot":"../../../src"}