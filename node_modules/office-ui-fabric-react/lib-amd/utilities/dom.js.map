{"version":3,"sources":["utilities/dom.ts"],"names":[],"mappings":"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","file":"utilities/dom.js","sourcesContent":["import { IRectangle } from '../common/IRectangle';\n\n/**\n * Attached interface for elements which support virtual references.\n * Used internally by the virtual hierarchy methods.\n *\n * @interface IVirtualElement\n * @extends {HTMLElement}\n */\ninterface IVirtualElement extends HTMLElement {\n  _virtual: {\n    parent?: IVirtualElement;\n    children: IVirtualElement[];\n  };\n}\n\n/**\n * Sets the virtual parent of an element.\n * Pass `undefined` as the `parent` to clear the virtual parent.\n *\n * @export\n * @param {HTMLElement} child\n * @param {HTMLElement} parent\n */\nexport function setVirtualParent(child: HTMLElement, parent: HTMLElement) {\n  let virtualChild = <IVirtualElement>child;\n  let virtualParent = <IVirtualElement>parent;\n\n  if (!virtualChild._virtual) {\n    virtualChild._virtual = {\n      children: []\n    };\n  }\n\n  let oldParent = virtualChild._virtual.parent;\n\n  if (oldParent && oldParent !== parent) {\n    // Remove the child from its old parent.\n    let index = oldParent._virtual.children.indexOf(virtualChild);\n\n    if (index > -1) {\n      oldParent._virtual.children.splice(index, 1);\n    }\n  }\n\n  virtualChild._virtual.parent = virtualParent || undefined;\n\n  if (virtualParent) {\n    if (!virtualParent._virtual) {\n      virtualParent._virtual = {\n        children: []\n      };\n    }\n\n    virtualParent._virtual.children.push(virtualChild);\n  }\n}\n\nexport function getVirtualParent(child: HTMLElement): HTMLElement {\n  let parent: HTMLElement;\n\n  if (child && isVirtualElement(child)) {\n    parent = child._virtual.parent;\n  }\n\n  return parent;\n}\n\n/**\n * Gets the element which is the parent of a given element.\n * If `allowVirtuaParents` is `true`, this method prefers the virtual parent over\n * real DOM parent when present.\n *\n * @export\n * @param {HTMLElement} child\n * @param {boolean} [allowVirtualParents=true]\n * @returns {HTMLElement}\n */\nexport function getParent(child: HTMLElement, allowVirtualParents: boolean = true): HTMLElement {\n  return child && (\n    allowVirtualParents && getVirtualParent(child) ||\n    child.parentNode && child.parentNode as HTMLElement\n  );\n}\n\n/**\n * Determines whether or not a parent element contains a given child element.\n * If `allowVirtualParents` is true, this method may return `true` if the child\n * has the parent in its virtual element hierarchy.\n *\n * @export\n * @param {HTMLElement} parent\n * @param {HTMLElement} child\n * @param {boolean} [allowVirtualParents=true]\n * @returns {boolean}\n */\nexport function elementContains(parent: HTMLElement, child: HTMLElement, allowVirtualParents: boolean = true): boolean {\n  let isContained: boolean = false;\n\n  if (parent && child) {\n    if (allowVirtualParents) {\n      isContained = false;\n\n      while (child) {\n        let nextParent = getParent(child);\n\n        if (nextParent === parent) {\n          isContained = true;\n          break;\n        }\n\n        child = nextParent;\n      }\n    } else if (parent.contains) {\n      isContained = parent.contains(child);\n    }\n  }\n\n  return isContained;\n}\n\nlet _isSSR = false;\n\n/** Helper to set ssr mode to simulate no window object returned from getWindow helper. */\nexport function setSSR(isEnabled) {\n  _isSSR = isEnabled;\n}\n\n/** Helper to get the window object. */\nexport function getWindow(rootElement?: HTMLElement) {\n  if (_isSSR) {\n    return undefined;\n  } else {\n    return (\n      rootElement &&\n        rootElement.ownerDocument &&\n        rootElement.ownerDocument.defaultView ?\n        rootElement.ownerDocument.defaultView :\n        window\n    );\n  }\n}\n\n/** Helper to get the document object. */\nexport function getDocument(rootElement?: HTMLElement) {\n  if (_isSSR) {\n    return undefined;\n  } else {\n    return rootElement && rootElement.ownerDocument ? rootElement.ownerDocument : document;\n  }\n}\n\n/** Helper to get bounding client rect, works with window. */\nexport function getRect(element: HTMLElement | Window): IRectangle {\n  let rect: IRectangle;\n\n  if (element) {\n    if (element === window) {\n      rect = {\n        left: 0,\n        top: 0,\n        width: window.innerWidth,\n        height: window.innerHeight,\n        right: window.innerWidth,\n        bottom: window.innerHeight\n      };\n    } else if ((element as HTMLElement).getBoundingClientRect) {\n      rect = (element as HTMLElement).getBoundingClientRect();\n    }\n  }\n\n  return rect;\n}\n\n/**\n * Determines whether or not an element has the virtual hierarchy extension.\n *\n * @param {(HTMLElement | IVirtualElement)} element\n * @returns {element is IVirtualElement}\n */\nfunction isVirtualElement(element: HTMLElement | IVirtualElement): element is IVirtualElement {\n  return element && !!(<IVirtualElement>element)._virtual;\n}"],"sourceRoot":"../../src"}